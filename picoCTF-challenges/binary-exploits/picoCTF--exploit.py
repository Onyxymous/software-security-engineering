# picoCTF--exploit.py
# by Aidan Wech (ahwech)
# nc .picoctf.net xxxxx

from pwn import *

def main():
    # connection variables (remember to start up instance on picoCTF, port will vary!)
    # host = ".picoctf.net"
    # port = xxxxx

    # debug varibles
    bin = ELF('./vuln')
    context.binary = bin
    context.log_level = "debug"

    # variables
    offset = 200
    payload = cyclic(offset)

    # debug payload file
    f = open("payload.txt", "wb")
    f.write(payload)
    f.close()

    # connect to instance
    # p = remote(host, port)
    p = process(bin.path)
    p.interactive()

    # print flag
    # log.info(f"flag: {flag}")

if __name__ == "__main__":
    main()